# دليل نظام QR Code المتكامل
# Comprehensive QR Code System Guide

## 📋 نظرة عامة على النظام

تم تطوير نظام QR Code متكامل ومتسق لإدارة باقات غسيل السيارات بطريقة رقمية ذكية. النظام يوفر حلاً شاملاً من شراء الباقة حتى استخدامها في الفروع.

## 🏗️ هيكل النظام

### 1. النظام المركزي (`utils/qrSystem.js`)
```javascript
// الملف الرئيسي الذي يحتوي على جميع الوظائف الأساسية
export const PACKAGE_TYPES = { ... }
export const CAR_TYPES = { ... }
export const generateQRCode = (packageData, customerData, branchData) => { ... }
export const validateQRCode = (qrData) => { ... }
export const useWash = (qrData, branchName) => { ... }
```

### 2. المكونات الرئيسية
- **QRCodeScanner**: ماسح QR Code للفروع
- **PackageDetails**: صفحة تفاصيل الباقة
- **Checkout**: صفحة الدفع
- **PaymentSuccess**: صفحة نجاح الدفع
- **QRDashboard**: لوحة تحكم QR Code

## 🔄 سير العمل (Workflow)

### المرحلة 1: شراء الباقة
1. **اختيار الباقة** (`/packages`)
   - اختيار نوع الباقة (أساسية، متقدمة، شاملة، VIP)
   - اختيار نوع السيارة
   - إدخال بيانات العميل

2. **تفاصيل الباقة** (`/package-details`)
   - عرض تفاصيل الباقة المختارة
   - تأكيد البيانات
   - الانتقال للدفع

3. **الدفع** (`/checkout`)
   - اختيار طريقة الدفع
   - معالجة الدفع
   - إنشاء QR Code تلقائياً

### المرحلة 2: إنشاء QR Code
```javascript
// إنشاء QR Code باستخدام النظام المركزي
const qrData = generateQRCode(packageDetails, customerData, branchData);
```

**هيكل بيانات QR Code:**
```javascript
{
  operationId: 'O12345678',           // رقم العملية الفريد
  packageType: 'premium',             // نوع الباقة
  packageName: 'الباقة الشاملة',      // اسم الباقة
  carType: 'medium',                  // نوع السيارة
  customerName: 'أحمد محمد',          // اسم العميل
  customerPhone: '+966501234567',     // رقم الهاتف
  customerEmail: 'ahmed@example.com', // البريد الإلكتروني
  remainingWashes: 18,                // الغسلات المتبقية
  totalWashes: 18,                    // إجمالي الغسلات
  price: 490,                         // السعر
  originalPrice: 770,                 // السعر الأصلي
  savings: 280,                       // التوفير
  branchName: 'الفرع الرئيسي',        // اسم الفرع
  branchId: 'BR001',                  // معرف الفرع
  branchAddress: 'شارع الملك فهد',    // عنوان الفرع
  branchPhone: '+966112345678',       // هاتف الفرع
  startDate: '2024-01-01T00:00:00Z',  // تاريخ البداية
  expiryDate: '2024-02-01T00:00:00Z', // تاريخ الانتهاء
  packageStatus: 'active',            // حالة الباقة
  lastUsed: null,                     // آخر استخدام
  usageHistory: [],                   // سجل الاستخدام
  createdAt: '2024-01-01T00:00:00Z',  // تاريخ الإنشاء
  version: '1.0'                      // إصدار النظام
}
```

### المرحلة 3: استخدام الباقة
1. **مسح QR Code** (`/qr-scanner`)
   - استخدام كاميرا الهاتف لمسح QR Code
   - التحقق من صحة البيانات
   - عرض حالة الباقة

2. **استخدام الغسلة**
   - خصم غسلة واحدة
   - تحديث سجل الاستخدام
   - حفظ البيانات المحدثة

## 🛠️ الوظائف الأساسية

### 1. التحقق من صحة QR Code
```javascript
const validation = validateQRCode(qrData);
// Returns: { isValid, isExpired, daysRemaining, hasWashes, status }
```

### 2. استخدام غسلة
```javascript
const result = useWash(qrData, branchName);
// Returns: { success, data } or { success: false, error }
```

### 3. الحصول على معلومات الباقة
```javascript
const packageInfo = getPackageInfo('premium');
const packageColor = getPackageColor('premium');
const packageName = getPackageName('premium');
```

### 4. تحميل ومشاركة QR Code
```javascript
downloadQRCode(qrData);
copyQRData(qrData);
shareQRCode(qrData);
```

## 📱 المكونات التفاعلية

### QRCodeScanner
- **الكاميرا الحقيقية**: يستخدم كاميرا الهاتف
- **التحقق الذكي**: يتحقق من صحة البيانات
- **الواجهة التفاعلية**: يعرض حالة الباقة
- **الاختبار التجريبي**: زر لاختبار النظام

### PackageDetails
- **عرض تفاعلي**: تفاصيل الباقة مع الرسوم المتحركة
- **اختيار نوع السيارة**: واجهة سهلة الاستخدام
- **معلومات العميل**: نموذج شامل
- **التكامل مع النظام المركزي**: حفظ البيانات بالشكل الصحيح

### Checkout
- **طرق دفع متعددة**: بطاقة ائتمان، Apple Pay، مدى
- **معالجة آمنة**: محاكاة عملية الدفع
- **إنشاء QR Code تلقائي**: بعد نجاح الدفع
- **حفظ البيانات**: في localStorage

### PaymentSuccess
- **عرض QR Code**: مع خلفية ملونة حسب نوع الباقة
- **أزرار التفاعل**: تحميل، نسخ، مشاركة
- **تفاصيل شاملة**: معلومات العميل والباقة والدفع
- **التنقل السلس**: إلى الصفحات المختلفة

## 🎨 التصميم والألوان

### ألوان الباقات
```javascript
const PACKAGE_COLORS = {
  basic: 'from-blue-500 to-blue-600',     // أزرق
  advanced: 'from-green-500 to-green-600', // أخضر
  premium: 'from-purple-500 to-purple-600', // بنفسجي
  vip: 'from-yellow-500 to-yellow-600'     // أصفر
};
```

### أنواع السيارات
```javascript
const CAR_TYPES = {
  small: 'صغيرة',    // سيدان، هاتشباك
  medium: 'متوسطة',  // SUV، كروس أوفر
  large: 'كبيرة'     // فان، بيك أب
};
```

## 🔒 الأمان والتحقق

### التحقق من البيانات
- التحقق من وجود البيانات الأساسية
- التحقق من تاريخ الانتهاء
- التحقق من الغسلات المتبقية
- التحقق من صحة تنسيق البيانات

### حماية البيانات
- تشفير البيانات في QR Code
- حفظ آمن في localStorage
- التحقق من صحة المعاملات
- سجل شامل للاستخدام

## 📊 تتبع الاستخدام

### سجل الاستخدام
```javascript
usageHistory: [
  {
    date: '2024-01-15T10:30:00Z',
    branchName: 'الفرع الرئيسي',
    washNumber: 1,
    action: 'wash_used'
  }
]
```

### إحصائيات الباقة
- عدد الغسلات المستخدمة
- عدد الغسلات المتبقية
- تاريخ آخر استخدام
- الأيام المتبقية للصلاحية

## 🚀 الميزات المتقدمة

### 1. التحميل والمشاركة
- تحميل QR Code كصورة PNG
- نسخ بيانات QR Code
- مشاركة QR Code عبر التطبيقات

### 2. التنبيهات الذكية
- تنبيه عند قرب انتهاء الصلاحية
- تنبيه عند نفاد الغسلات
- تنبيه عند انتهاء الباقة

### 3. التصدير والاستيراد
- تصدير بيانات QR Code كملف JSON
- استيراد بيانات QR Code من ملف
- نسخ احتياطي للبيانات

## 🔧 التطوير والصيانة

### إضافة باقة جديدة
```javascript
// في utils/qrSystem.js
export const PACKAGE_TYPES = {
  // ... الباقات الموجودة
  newPackage: {
    name: 'الباقة الجديدة',
    color: 'from-red-500 to-red-600',
    icon: 'NewIcon',
    validity: 30,
    defaultWashes: 10
  }
};
```

### إضافة نوع سيارة جديد
```javascript
export const CAR_TYPES = {
  // ... الأنواع الموجودة
  extraLarge: 'كبيرة جداً'
};
```

### تحديث الوظائف
- جميع الوظائف مركزية في `utils/qrSystem.js`
- سهولة التحديث والصيانة
- توافق مع جميع المكونات

## 📱 الاستخدام العملي

### للعملاء
1. شراء الباقة من التطبيق
2. الحصول على QR Code فوري
3. الذهاب للفرع ومسح QR Code
4. الحصول على الخدمة فوراً

### للفروع
1. مسح QR Code بالكاميرا
2. التحقق من صحة الباقة
3. خصم غسلة واحدة
4. تحديث البيانات تلقائياً

### للإدارة
1. تتبع جميع العمليات
2. إحصائيات مفصلة
3. إدارة الباقات والصلاحيات
4. تقارير الاستخدام

## 🎯 الفوائد

### للعملاء
- سهولة الاستخدام
- توفير الوقت
- تتبع الباقات
- شفافية كاملة

### للشركة
- إدارة مركزية
- تقليل الأخطاء
- تتبع دقيق
- تحسين الخدمة

### للفروع
- سرعة في المعاملات
- دقة في البيانات
- سهولة في الاستخدام
- تقليل الأخطاء البشرية

## 🔮 التطوير المستقبلي

### الميزات المخطط لها
- دعم الباركود
- NFC tags
- تطبيق موبايل منفصل
- نظام نقاط ومكافآت
- دعم العملات الرقمية
- تكامل مع أنظمة الدفع الخارجية

### التحسينات التقنية
- قاعدة بيانات مركزية
- API للفروع
- نظام إشعارات
- تحليلات متقدمة
- أمان محسن

---

**ملاحظة**: هذا النظام مصمم ليكون مرناً وقابلاً للتطوير، مع الحفاظ على البساطة وسهولة الاستخدام. 